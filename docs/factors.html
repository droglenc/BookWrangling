<!DOCTYPE html>
<html lang="en" xml:lang="en">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 10 Factors | Readings for MTH250 - Data Wrangling</title>
  <meta name="description" content="This book contains the readings for MTH250W at Northland College." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 10 Factors | Readings for MTH250 - Data Wrangling" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://derekogle.com/BookWrangling/" />
  
  <meta property="og:description" content="This book contains the readings for MTH250W at Northland College." />
  <meta name="github-repo" content="droglenc/BookWrangling" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 10 Factors | Readings for MTH250 - Data Wrangling" />
  
  <meta name="twitter:description" content="This book contains the readings for MTH250W at Northland College." />
  

<meta name="author" content="Derek H. Ogle" />


<meta name="date" content="2021-08-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dates-and-times.html"/>
<link rel="next" href="strings.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Readings for Data Wrangling in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="preparation.html"><a href="preparation.html"><i class="fa fa-check"></i><b>1</b> Preparation</a>
<ul>
<li class="chapter" data-level="1.1" data-path="preparation.html"><a href="preparation.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="preparation.html"><a href="preparation.html#optimally-configuring-rstudio"><i class="fa fa-check"></i><b>1.2</b> Optimally Configuring RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="preparation.html"><a href="preparation.html#install-tidyverse-and-other-packages"><i class="fa fa-check"></i><b>1.3</b> Install Tidyverse and Other Packages</a></li>
<li class="chapter" data-level="1.4" data-path="preparation.html"><a href="preparation.html#rstudio-projects"><i class="fa fa-check"></i><b>1.4</b> RStudio Projects</a></li>
<li class="chapter" data-level="1.5" data-path="preparation.html"><a href="preparation.html#using-the-notebook-template"><i class="fa fa-check"></i><b>1.5</b> Using the Notebook Template</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>2</b> Data Structures</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-structures.html"><a href="data-structures.html#vectors"><i class="fa fa-check"></i><b>2.1</b> Vectors</a></li>
<li class="chapter" data-level="2.2" data-path="data-structures.html"><a href="data-structures.html#data-classes"><i class="fa fa-check"></i><b>2.2</b> Data Classes</a></li>
<li class="chapter" data-level="2.3" data-path="data-structures.html"><a href="data-structures.html#data-frames"><i class="fa fa-check"></i><b>2.3</b> Data Frames</a></li>
<li class="chapter" data-level="2.4" data-path="data-structures.html"><a href="data-structures.html#tidy-data"><i class="fa fa-check"></i><b>2.4</b> Tidy Data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="read-external-data-files.html"><a href="read-external-data-files.html"><i class="fa fa-check"></i><b>3</b> Read External Data Files</a>
<ul>
<li class="chapter" data-level="3.1" data-path="read-external-data-files.html"><a href="read-external-data-files.html#entering-data"><i class="fa fa-check"></i><b>3.1</b> Entering Data</a></li>
<li class="chapter" data-level="3.2" data-path="read-external-data-files.html"><a href="read-external-data-files.html#saving-the-external-file"><i class="fa fa-check"></i><b>3.2</b> Saving the External File</a></li>
<li class="chapter" data-level="3.3" data-path="read-external-data-files.html"><a href="read-external-data-files.html#reading-an-external-file"><i class="fa fa-check"></i><b>3.3</b> Reading an External File</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="relational-data.html"><a href="relational-data.html"><i class="fa fa-check"></i><b>4</b> Relational Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="relational-data.html"><a href="relational-data.html#nature-of-relational-data"><i class="fa fa-check"></i><b>4.1</b> Nature of Relational Data</a></li>
<li class="chapter" data-level="4.2" data-path="relational-data.html"><a href="relational-data.html#join-concepts"><i class="fa fa-check"></i><b>4.2</b> Join Concepts</a></li>
<li class="chapter" data-level="4.3" data-path="relational-data.html"><a href="relational-data.html#joins-in-r"><i class="fa fa-check"></i><b>4.3</b> Joins in R</a></li>
<li class="chapter" data-level="4.4" data-path="relational-data.html"><a href="relational-data.html#examples-with-context"><i class="fa fa-check"></i><b>4.4</b> Examples With Context</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pivot.html"><a href="pivot.html"><i class="fa fa-check"></i><b>5</b> Pivot</a>
<ul>
<li class="chapter" data-level="5.1" data-path="pivot.html"><a href="pivot.html#data-formats"><i class="fa fa-check"></i><b>5.1</b> Data Formats</a></li>
<li class="chapter" data-level="5.2" data-path="pivot.html"><a href="pivot.html#pivoting-concepts"><i class="fa fa-check"></i><b>5.2</b> Pivoting Concepts</a></li>
<li class="chapter" data-level="5.3" data-path="pivot.html"><a href="pivot.html#pivoting-in-r"><i class="fa fa-check"></i><b>5.3</b> Pivoting in R</a></li>
<li class="chapter" data-level="5.4" data-path="pivot.html"><a href="pivot.html#pivoting-examples"><i class="fa fa-check"></i><b>5.4</b> Examples with Context</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="wrangle-columns.html"><a href="wrangle-columns.html"><i class="fa fa-check"></i><b>6</b> Wrangle Columns</a>
<ul>
<li class="chapter" data-level="6.1" data-path="wrangle-columns.html"><a href="wrangle-columns.html#dplyr-verbs"><i class="fa fa-check"></i><b>6.1</b> <code>dplyr</code> verbs</a></li>
<li class="chapter" data-level="6.2" data-path="wrangle-columns.html"><a href="wrangle-columns.html#pipe"><i class="fa fa-check"></i><b>6.2</b> Pipe</a></li>
<li class="chapter" data-level="6.3" data-path="wrangle-columns.html"><a href="wrangle-columns.html#selecting-variables"><i class="fa fa-check"></i><b>6.3</b> Selecting Variables</a></li>
<li class="chapter" data-level="6.4" data-path="wrangle-columns.html"><a href="wrangle-columns.html#moving-variables"><i class="fa fa-check"></i><b>6.4</b> Moving Variables</a></li>
<li class="chapter" data-level="6.5" data-path="wrangle-columns.html"><a href="wrangle-columns.html#renaming-variables"><i class="fa fa-check"></i><b>6.5</b> Renaming Variables</a></li>
<li class="chapter" data-level="6.6" data-path="wrangle-columns.html"><a href="wrangle-columns.html#adding-variables"><i class="fa fa-check"></i><b>6.6</b> Adding Variables</a></li>
<li class="chapter" data-level="6.7" data-path="wrangle-columns.html"><a href="wrangle-columns.html#columns-examples"><i class="fa fa-check"></i><b>6.7</b> Examples in Context</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="wrangle-rows.html"><a href="wrangle-rows.html"><i class="fa fa-check"></i><b>7</b> Wrangle Rows</a>
<ul>
<li class="chapter" data-level="7.1" data-path="wrangle-rows.html"><a href="wrangle-rows.html#selecting-specific-rows"><i class="fa fa-check"></i><b>7.1</b> Selecting Specific Rows</a></li>
<li class="chapter" data-level="7.2" data-path="wrangle-rows.html"><a href="wrangle-rows.html#filtering-rows"><i class="fa fa-check"></i><b>7.2</b> Filtering Rows</a></li>
<li class="chapter" data-level="7.3" data-path="wrangle-rows.html"><a href="wrangle-rows.html#arranging-rows"><i class="fa fa-check"></i><b>7.3</b> Arranging Rows</a></li>
<li class="chapter" data-level="7.4" data-path="wrangle-rows.html"><a href="wrangle-rows.html#appending-rows"><i class="fa fa-check"></i><b>7.4</b> Appending Rows</a></li>
<li class="chapter" data-level="7.5" data-path="wrangle-rows.html"><a href="wrangle-rows.html#examples-in-context"><i class="fa fa-check"></i><b>7.5</b> Examples in Context</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="groupings.html"><a href="groupings.html"><i class="fa fa-check"></i><b>8</b> Groupings</a>
<ul>
<li class="chapter" data-level="8.1" data-path="groupings.html"><a href="groupings.html#declaring-groupings"><i class="fa fa-check"></i><b>8.1</b> Declaring Groupings</a></li>
<li class="chapter" data-level="8.2" data-path="groupings.html"><a href="groupings.html#summarizing-by-groups"><i class="fa fa-check"></i><b>8.2</b> Summarizing by Groups</a></li>
<li class="chapter" data-level="8.3" data-path="groupings.html"><a href="groupings.html#wrangling-by-group"><i class="fa fa-check"></i><b>8.3</b> Wrangling by Group</a></li>
<li class="chapter" data-level="8.4" data-path="groupings.html"><a href="groupings.html#ungrouping"><i class="fa fa-check"></i><b>8.4</b> Ungrouping</a></li>
<li class="chapter" data-level="8.5" data-path="groupings.html"><a href="groupings.html#examples-in-context-1"><i class="fa fa-check"></i><b>8.5</b> Examples in Context</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="dates-and-times.html"><a href="dates-and-times.html"><i class="fa fa-check"></i><b>9</b> Dates and Times</a>
<ul>
<li class="chapter" data-level="9.1" data-path="dates-and-times.html"><a href="dates-and-times.html#obtaining-dates-data"><i class="fa fa-check"></i><b>9.1</b> Obtaining Dates Data</a></li>
<li class="chapter" data-level="9.2" data-path="dates-and-times.html"><a href="dates-and-times.html#extracting-date-components"><i class="fa fa-check"></i><b>9.2</b> Extracting Date Components</a></li>
<li class="chapter" data-level="9.3" data-path="dates-and-times.html"><a href="dates-and-times.html#calculations-with-dates"><i class="fa fa-check"></i><b>9.3</b> Calculations with Dates</a></li>
<li class="chapter" data-level="9.4" data-path="dates-and-times.html"><a href="dates-and-times.html#obtaining-time-data"><i class="fa fa-check"></i><b>9.4</b> Obtaining Time Data</a></li>
<li class="chapter" data-level="9.5" data-path="dates-and-times.html"><a href="dates-and-times.html#extracting-time-components"><i class="fa fa-check"></i><b>9.5</b> Extracting Time Components</a></li>
<li class="chapter" data-level="9.6" data-path="dates-and-times.html"><a href="dates-and-times.html#calculations-with-date-times"><i class="fa fa-check"></i><b>9.6</b> Calculations with Date-Times</a></li>
<li class="chapter" data-level="9.7" data-path="dates-and-times.html"><a href="dates-and-times.html#examples-in-context-2"><i class="fa fa-check"></i><b>9.7</b> Examples in Context</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="factors.html"><a href="factors.html"><i class="fa fa-check"></i><b>10</b> Factors</a>
<ul>
<li class="chapter" data-level="10.1" data-path="factors.html"><a href="factors.html#creating-factors"><i class="fa fa-check"></i><b>10.1</b> Creating Factors</a></li>
<li class="chapter" data-level="10.2" data-path="factors.html"><a href="factors.html#changing-factor-order"><i class="fa fa-check"></i><b>10.2</b> Changing Factor Order</a></li>
<li class="chapter" data-level="10.3" data-path="factors.html"><a href="factors.html#changing-factor-levels"><i class="fa fa-check"></i><b>10.3</b> Changing Factor Levels</a></li>
<li class="chapter" data-level="10.4" data-path="factors.html"><a href="factors.html#examples-in-context-3"><i class="fa fa-check"></i><b>10.4</b> Examples in Context</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>11</b> Strings</a></li>
<li class="divider"></li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Readings for MTH250 - Data Wrangling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="factors" class="section level1" number="10">
<h1><span class="header-section-number">Module 10</span> Factors</h1>
<p>Factors are a special case of character variables in R. Factors are primarily used for categorical data, especially if summaries of that data are to be displayed in other than alphabetical order. For example, a simple count of the number of observations in each <code>loc</code> of the <code>bears</code> data frame introduced in Section <a href="read-external-data-files.html#csv-files">3.3.1</a> shows that the categories of the character variable are displayed alphabetically by default.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb480-1"><a href="factors.html#cb480-1" aria-hidden="true" tabindex="-1"></a>bears <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;Bears.csv&quot;</span>))</span>
<span id="cb480-2"><a href="factors.html#cb480-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> bears <span class="sc">%&gt;%</span></span>
<span id="cb480-3"><a href="factors.html#cb480-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(loc) <span class="sc">%&gt;%</span></span>
<span id="cb480-4"><a href="factors.html#cb480-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>())</span>
<span id="cb480-5"><a href="factors.html#cb480-5" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 3 x 2
#R&gt;    loc          n
#R&gt;    &lt;chr&gt;    &lt;int&gt;
#R&gt;  1 Ashland      2
#R&gt;  2 Bayfield     3
#R&gt;  3 Douglas      3</code></pre>
<p>To display these results in other than alphabetical order will require the use of factors, which will be illustrated in this module.</p>
<p>Factors have a long and, for some, dubious history in R. The <code>forcats</code> package was developed to aid working with factors in R. While it is not critical to understanding the methods of this module, the <a href="http://simplystatistics.org/2015/07/24/stringsasfactors-an-unauthorized-biography/">stringsAsFactors: An unauthorized biography</a> and <a href="http://notstatschat.tumblr.com/post/124987394001/stringsasfactors-sigh">stringsAsFactors = &lt;sigh&gt;</a> are interesting reads about how unforeseen issues can arise when using factors. Many of these issues are addressed when using <code>forcats</code>, which is loaded with <code>tidyverse</code>.</p>
<p> </p>
<div id="creating-factors" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Creating Factors</h2>
<p>A variable is converted to a factor class by including that variable in <code class="inline">factor()</code>. The code below creates a new data frame where <code>loc</code> is now a factor, as indicated by <code>&lt;fct&gt;</code> below <code>loc</code> when the tibble is printed.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb482-1"><a href="factors.html#cb482-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> bears <span class="sc">%&gt;%</span></span>
<span id="cb482-2"><a href="factors.html#cb482-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loc=</span><span class="fu">factor</span>(loc))</span>
<span id="cb482-3"><a href="factors.html#cb482-3" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 8 x 3
#R&gt;    length.cm weight.kg loc     
#R&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;   
#R&gt;  1      139        110 Bayfield
#R&gt;  2      120.        60 Bayfield
#R&gt;  3      149         85 Bayfield
#R&gt;  4      141        100 Ashland 
#R&gt;  5      141         95 Ashland 
#R&gt;  6      150         85 Douglas 
#R&gt;  7      130.       105 Douglas 
#R&gt;  8      150        110 Douglas</code></pre>
<p>Nothing is changed when the data are displayed as above. However, behind-the-scenes the factor variable consists of numerical codes that are mapped to levels (i.e., the categories) of the factor variable. The order here is still alphabetical because the order of the levels was not specifically controlled when creating the factor variable. Thus, behind-the-scenes “1” is mapped to “Ashland,” “2” to “Bayfield,” and “3” to “Douglas.” This mapping is shown with <code>loc_nums</code> below.</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb484-1"><a href="factors.html#cb484-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">loc_nums=</span><span class="fu">as.numeric</span>(loc))</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 8 x 4
#R&gt;    length.cm weight.kg loc      loc_nums
#R&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;       &lt;dbl&gt;
#R&gt;  1      139        110 Bayfield        2
#R&gt;  2      120.        60 Bayfield        2
#R&gt;  3      149         85 Bayfield        2
#R&gt;  4      141        100 Ashland         1
#R&gt;  5      141         95 Ashland         1
#R&gt;  6      150         85 Douglas         3
#R&gt;  7      130.       105 Douglas         3
#R&gt;  8      150        110 Douglas         3</code></pre>
<p>Suppose, however, that we prefer that the levels of the <code>loc</code> variable be ordered from West to East, as in Douglas than Bayfield and then Ashland. The specific order of the levels can be set by supplying the ordered levels in a vector given to <code class="inline">levels=</code> within <code class="inline">factor()</code>.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb486-1"><a href="factors.html#cb486-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> bears <span class="sc">%&gt;%</span></span>
<span id="cb486-2"><a href="factors.html#cb486-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loc=</span><span class="fu">factor</span>(loc,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Douglas&quot;</span>,<span class="st">&quot;Bayfield&quot;</span>,<span class="st">&quot;Ashland&quot;</span>)))</span>
<span id="cb486-3"><a href="factors.html#cb486-3" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 8 x 3
#R&gt;    length.cm weight.kg loc     
#R&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;   
#R&gt;  1      139        110 Bayfield
#R&gt;  2      120.        60 Bayfield
#R&gt;  3      149         85 Bayfield
#R&gt;  4      141        100 Ashland 
#R&gt;  5      141         95 Ashland 
#R&gt;  6      150         85 Douglas 
#R&gt;  7      130.       105 Douglas 
#R&gt;  8      150        110 Douglas</code></pre>
<p>Again, the data are not fundamentally altered, but the codes underlying the factor variables are.<a href="#fn47" class="footnote-ref" id="fnref47"><sup>47</sup></a></p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb488-1"><a href="factors.html#cb488-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">loc_nums=</span><span class="fu">as.numeric</span>(loc))</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 8 x 4
#R&gt;    length.cm weight.kg loc      loc_nums
#R&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;       &lt;dbl&gt;
#R&gt;  1      139        110 Bayfield        2
#R&gt;  2      120.        60 Bayfield        2
#R&gt;  3      149         85 Bayfield        2
#R&gt;  4      141        100 Ashland         3
#R&gt;  5      141         95 Ashland         3
#R&gt;  6      150         85 Douglas         1
#R&gt;  7      130.       105 Douglas         1
#R&gt;  8      150        110 Douglas         1</code></pre>
<p>When setting the levels of a factor variable make sure that all levels are spelled exactly as they are in the original variable. For example, see the major problem created below when a level is erroneously set (i.e., “bayfield” is not capitalized).</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb490-1"><a href="factors.html#cb490-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> bears <span class="sc">%&gt;%</span></span>
<span id="cb490-2"><a href="factors.html#cb490-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loc=</span><span class="fu">factor</span>(loc,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Douglas&quot;</span>,<span class="st">&quot;bayfield&quot;</span>,<span class="st">&quot;Ashland&quot;</span>)))</span>
<span id="cb490-3"><a href="factors.html#cb490-3" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 8 x 3
#R&gt;    length.cm weight.kg loc    
#R&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;  
#R&gt;  1      139        110 &lt;NA&gt;   
#R&gt;  2      120.        60 &lt;NA&gt;   
#R&gt;  3      149         85 &lt;NA&gt;   
#R&gt;  4      141        100 Ashland
#R&gt;  5      141         95 Ashland
#R&gt;  6      150         85 Douglas
#R&gt;  7      130.       105 Douglas
#R&gt;  8      150        110 Douglas</code></pre>
<p>Additionally, make sure to include all possible levels when creating the levels.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb492-1"><a href="factors.html#cb492-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> bears <span class="sc">%&gt;%</span></span>
<span id="cb492-2"><a href="factors.html#cb492-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loc=</span><span class="fu">factor</span>(loc,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Douglas&quot;</span>,<span class="st">&quot;Ashland&quot;</span>)))</span>
<span id="cb492-3"><a href="factors.html#cb492-3" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 8 x 3
#R&gt;    length.cm weight.kg loc    
#R&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;  
#R&gt;  1      139        110 &lt;NA&gt;   
#R&gt;  2      120.        60 &lt;NA&gt;   
#R&gt;  3      149         85 &lt;NA&gt;   
#R&gt;  4      141        100 Ashland
#R&gt;  5      141         95 Ashland
#R&gt;  6      150         85 Douglas
#R&gt;  7      130.       105 Douglas
#R&gt;  8      150        110 Douglas</code></pre>
<p>Given these last two issues it is important to understand what levels exist within a variable. If the variable is a character class (and not yet a factor) then use <code class="inline">unique()</code> to see the list of levels.</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb494-1"><a href="factors.html#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(bears<span class="sc">$</span>loc)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;Bayfield&quot; &quot;Ashland&quot;  &quot;Douglas&quot;</code></pre>
<p>However, if the variable is a factor class already then use <code class="inline">levels()</code> to see the list of levels along with their order.</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb496-1"><a href="factors.html#cb496-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(tmp<span class="sc">$</span>loc)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;Douglas&quot; &quot;Ashland&quot;</code></pre>
<p> </p>
</div>
<div id="changing-factor-order" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Changing Factor Order</h2>
<p>Factor levels can be manually reordered using <code class="inline">levels=</code> as shown in the previous section. However functions in <code>forcats</code> provide other methods to simplify reordering levels for common situations.</p>
<p>Levels can be reordered based on the value of another variable with <code class="inline">fct_reorder()</code>. This function takes the factor variable as the first argument and a numeric variable that contains values for which to reorder the factor levels as the second argument. Optionally a third argument called <code class="inline">.fun</code> can be used to calculate a summary of the numeric variable to use for reordering.<a href="#fn48" class="footnote-ref" id="fnref48"><sup>48</sup></a></p>
<p>For example, the code below orders the levels in <code>loc</code> by the median length of the bears.</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb498-1"><a href="factors.html#cb498-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> bears <span class="sc">%&gt;%</span></span>
<span id="cb498-2"><a href="factors.html#cb498-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loc=</span><span class="fu">fct_reorder</span>(loc,length.cm))</span>
<span id="cb498-3"><a href="factors.html#cb498-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(tmp<span class="sc">$</span>loc)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;Bayfield&quot; &quot;Ashland&quot;  &quot;Douglas&quot;</code></pre>
<div class="sourceCode" id="cb500"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb500-1"><a href="factors.html#cb500-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Checking</span></span>
<span id="cb500-2"><a href="factors.html#cb500-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="sc">%&gt;%</span></span>
<span id="cb500-3"><a href="factors.html#cb500-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(loc) <span class="sc">%&gt;%</span></span>
<span id="cb500-4"><a href="factors.html#cb500-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>(),</span>
<span id="cb500-5"><a href="factors.html#cb500-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mdn=</span><span class="fu">median</span>(length.cm))</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 3 x 3
#R&gt;    loc          n   mdn
#R&gt;    &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt;
#R&gt;  1 Bayfield     3   139
#R&gt;  2 Ashland      2   141
#R&gt;  3 Douglas      3   150</code></pre>
<p>Alternatively, the code below orders the levels of <code>loc</code> by the minimum length of the bears (i.e., using <code class="inline">min</code> in <code>.fun=</code>).</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb502-1"><a href="factors.html#cb502-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> bears <span class="sc">%&gt;%</span></span>
<span id="cb502-2"><a href="factors.html#cb502-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loc=</span><span class="fu">fct_reorder</span>(loc,length.cm,<span class="at">.fun=</span>min))</span>
<span id="cb502-3"><a href="factors.html#cb502-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(tmp<span class="sc">$</span>loc)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;Bayfield&quot; &quot;Douglas&quot;  &quot;Ashland&quot;</code></pre>
<div class="sourceCode" id="cb504"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb504-1"><a href="factors.html#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Checking</span></span>
<span id="cb504-2"><a href="factors.html#cb504-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="sc">%&gt;%</span></span>
<span id="cb504-3"><a href="factors.html#cb504-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(loc) <span class="sc">%&gt;%</span></span>
<span id="cb504-4"><a href="factors.html#cb504-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>(),</span>
<span id="cb504-5"><a href="factors.html#cb504-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">min=</span><span class="fu">min</span>(length.cm))</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 3 x 3
#R&gt;    loc          n   min
#R&gt;    &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt;
#R&gt;  1 Bayfield     3  120.
#R&gt;  2 Douglas      3  130.
#R&gt;  3 Ashland      2  141</code></pre>
<p> </p>
<p>Specific levels are moved to the beginning of the order of levels with <code class="inline">fct_relevel()</code>. The first argument to this function is the factor variable and subsequent arguments are levels to move to the “beginning of the line.” For example, the following code moves “Bayfield” to the beginning of the order.</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb506-1"><a href="factors.html#cb506-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> bears <span class="sc">%&gt;%</span></span>
<span id="cb506-2"><a href="factors.html#cb506-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loc=</span><span class="fu">fct_relevel</span>(loc,<span class="st">&quot;Bayfield&quot;</span>))</span>
<span id="cb506-3"><a href="factors.html#cb506-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(tmp<span class="sc">$</span>loc)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;Bayfield&quot; &quot;Ashland&quot;  &quot;Douglas&quot;</code></pre>
<p>Alternatively, both “Bayfield” and “Douglas” are moved to the beginning below</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb508-1"><a href="factors.html#cb508-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> bears <span class="sc">%&gt;%</span></span>
<span id="cb508-2"><a href="factors.html#cb508-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loc=</span><span class="fu">fct_relevel</span>(loc,<span class="st">&quot;Bayfield&quot;</span>,<span class="st">&quot;Douglas&quot;</span>))</span>
<span id="cb508-3"><a href="factors.html#cb508-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(tmp<span class="sc">$</span>loc)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;Bayfield&quot; &quot;Douglas&quot;  &quot;Ashland&quot;</code></pre>
<p> </p>
<p>The order of levels for a factor variable are reversed with <code class="inline">fct_rev()</code>.</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb510-1"><a href="factors.html#cb510-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> bears <span class="sc">%&gt;%</span></span>
<span id="cb510-2"><a href="factors.html#cb510-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loc=</span><span class="fu">fct_rev</span>(loc))</span>
<span id="cb510-3"><a href="factors.html#cb510-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(tmp<span class="sc">$</span>loc)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;Douglas&quot;  &quot;Bayfield&quot; &quot;Ashland&quot;</code></pre>
<p>The <code class="inline">fct_rev()</code> function can be used with <code class="inline">fct_reorder()</code> to change the order from ascending to descending order. For example, the code below changes the factor levels to be in descending order of minimum length.</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb512-1"><a href="factors.html#cb512-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> bears <span class="sc">%&gt;%</span></span>
<span id="cb512-2"><a href="factors.html#cb512-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loc=</span><span class="fu">fct_reorder</span>(loc,length.cm,<span class="at">.fun=</span>min),</span>
<span id="cb512-3"><a href="factors.html#cb512-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">loc=</span><span class="fu">fct_rev</span>(loc))</span>
<span id="cb512-4"><a href="factors.html#cb512-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-5"><a href="factors.html#cb512-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Checking</span></span>
<span id="cb512-6"><a href="factors.html#cb512-6" aria-hidden="true" tabindex="-1"></a>tmp <span class="sc">%&gt;%</span></span>
<span id="cb512-7"><a href="factors.html#cb512-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(loc) <span class="sc">%&gt;%</span></span>
<span id="cb512-8"><a href="factors.html#cb512-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>(),</span>
<span id="cb512-9"><a href="factors.html#cb512-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">min=</span><span class="fu">min</span>(length.cm))</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 3 x 3
#R&gt;    loc          n   min
#R&gt;    &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt;
#R&gt;  1 Ashland      2  141 
#R&gt;  2 Douglas      3  130.
#R&gt;  3 Bayfield     3  120.</code></pre>
<p> </p>
<p>The <code class="inline">fct_infreq()</code> function is used to order the levels by <strong>de</strong>creasing frequency of their occurrence.</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb514-1"><a href="factors.html#cb514-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> bears <span class="sc">%&gt;%</span></span>
<span id="cb514-2"><a href="factors.html#cb514-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loc=</span><span class="fu">fct_infreq</span>(loc))</span>
<span id="cb514-3"><a href="factors.html#cb514-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb514-4"><a href="factors.html#cb514-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Checking</span></span>
<span id="cb514-5"><a href="factors.html#cb514-5" aria-hidden="true" tabindex="-1"></a>tmp <span class="sc">%&gt;%</span></span>
<span id="cb514-6"><a href="factors.html#cb514-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(loc) <span class="sc">%&gt;%</span></span>
<span id="cb514-7"><a href="factors.html#cb514-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>())</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 3 x 2
#R&gt;    loc          n
#R&gt;    &lt;fct&gt;    &lt;int&gt;
#R&gt;  1 Bayfield     3
#R&gt;  2 Douglas      3
#R&gt;  3 Ashland      2</code></pre>
<p>Of course, using <code class="inline">fct_rev()</code> with <code class="inline">fct_infreq()</code> would order the levels in <strong>as</strong>cending frequency of occurrence.</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb516-1"><a href="factors.html#cb516-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> bears <span class="sc">%&gt;%</span></span>
<span id="cb516-2"><a href="factors.html#cb516-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loc=</span><span class="fu">fct_rev</span>(<span class="fu">fct_infreq</span>(loc)))</span>
<span id="cb516-3"><a href="factors.html#cb516-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb516-4"><a href="factors.html#cb516-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Checking</span></span>
<span id="cb516-5"><a href="factors.html#cb516-5" aria-hidden="true" tabindex="-1"></a>tmp <span class="sc">%&gt;%</span></span>
<span id="cb516-6"><a href="factors.html#cb516-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(loc) <span class="sc">%&gt;%</span></span>
<span id="cb516-7"><a href="factors.html#cb516-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>())</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 3 x 2
#R&gt;    loc          n
#R&gt;    &lt;fct&gt;    &lt;int&gt;
#R&gt;  1 Ashland      2
#R&gt;  2 Douglas      3
#R&gt;  3 Bayfield     3</code></pre>
<p> </p>
</div>
<div id="changing-factor-levels" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Changing Factor Levels</h2>
<p>In some instances it may be beneficial to change the names of the levels or to collapse or lump levels together. Methods for performing these changes are demonstrated in this section using data on the density and basal area of tree species located on plots in the Apostle Islands that were designated as “Balsam Fir” plots. These data were extracted from <a href="https://irma.nps.gov/DataStore/DownloadFile/454366">Sanders and Grochowski (2012)</a><a href="#fn49" class="footnote-ref" id="fnref49"><sup>49</sup></a> and are stored in <a href="https://github.com/droglenc/BookWrangling/raw/main/data/APIS_FirPlots.xlsx">APIS_FirPlots.xlsx</a>.</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb518-1"><a href="factors.html#cb518-1" aria-hidden="true" tabindex="-1"></a>aip <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;APIS_FirPlots.xlsx&quot;</span>))</span>
<span id="cb518-2"><a href="factors.html#cb518-2" aria-hidden="true" tabindex="-1"></a>aip</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 26 x 4
#R&gt;      plot species                 density basal_area
#R&gt;     &lt;dbl&gt; &lt;chr&gt;                     &lt;dbl&gt;      &lt;dbl&gt;
#R&gt;   1  1011 Acer rubrum                11.1        0.4
#R&gt;   2  1011 Betula alleghaniensis     156.         1.7
#R&gt;   3  1011 Betula papyrifera          44.4        0.7
#R&gt;   4  1011 Sorbus decora              22.2        0.2
#R&gt;   5  1011 unknown tree - hardwood    11.1        0.6
#R&gt;   6  1011 Abies balsamea            878.         2.5
#R&gt;   7  1011 unknown tree - softwood   122.         1.2
#R&gt;   8  1031 Acer saccharum             55.6        0.1
#R&gt;   9  1031 Acer sp.                   44.4        0.3
#R&gt;  10  1031 Betula papyrifera          33.3        1.5
#R&gt;  # ... with 16 more rows</code></pre>
<p>These data are briefly summarized below.</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb520-1"><a href="factors.html#cb520-1" aria-hidden="true" tabindex="-1"></a>aip_sum1 <span class="ot">&lt;-</span> aip <span class="sc">%&gt;%</span></span>
<span id="cb520-2"><a href="factors.html#cb520-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb520-3"><a href="factors.html#cb520-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>(),</span>
<span id="cb520-4"><a href="factors.html#cb520-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">ttl_density=</span><span class="fu">sum</span>(density),</span>
<span id="cb520-5"><a href="factors.html#cb520-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">ttl_barea=</span><span class="fu">sum</span>(basal_area))</span>
<span id="cb520-6"><a href="factors.html#cb520-6" aria-hidden="true" tabindex="-1"></a>aip_sum1</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 14 x 4
#R&gt;     species                     n ttl_density ttl_barea
#R&gt;     &lt;chr&gt;                   &lt;int&gt;       &lt;dbl&gt;     &lt;dbl&gt;
#R&gt;   1 Abies balsamea              4      1000         2.8
#R&gt;   2 Acer rubrum                 1        11.1       0.4
#R&gt;   3 Acer saccharum              3        77.8       0.2
#R&gt;   4 Acer sp.                    1        44.4       0.3
#R&gt;   5 Acer spicatum               1        11.1       0  
#R&gt;   6 Betula alleghaniensis       3       178.        2.3
#R&gt;   7 Betula papyrifera           2        77.7       2.2
#R&gt;   8 Betula sp.                  1        11.1       0.3
#R&gt;   9 Populus tremuloides         1        22.2       1.5
#R&gt;  10 Quercus rubra               1        11.1       0  
#R&gt;  11 Sorbus decora               1        22.2       0.2
#R&gt;  12 Thuja occidentalis          1        11.1       0.7
#R&gt;  13 unknown tree - hardwood     4       111         4.3
#R&gt;  14 unknown tree - softwood     2       144.        1.2</code></pre>
<p>The summary above shows several species within a few genera (e.g., <em>Acer</em>). A researcher may wish to collapse these species into one level that represents the genera. For example, one may want to collapse “Acer rubrum,” “Acer saccharum,” “Acer spicatum,” and “Acer sp.” into a single level called “Acer sp.”</p>
<p>The “collapsing” of multiple levels into one level is accomplished with <code class="inline">fct_collapse()</code>. The first argument to this function is the factor variable containing the “old” levels. Subsequent arguments are formed by setting a new level name equal to a vector containing old level names to collapse.</p>
<p>For example the code below uses <code class="inline">fct_collapse()</code> to create a new <code>species2</code> variable that collapses the multiple “Acer” and “Betula” levels into two levels specific to each genera. To allow ease of comparison of the two “species” variables I then moved <code>species2</code> to be right after <code>species</code> and arranged the rows by <code>species</code>.<a href="#fn50" class="footnote-ref" id="fnref50"><sup>50</sup></a></p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb522-1"><a href="factors.html#cb522-1" aria-hidden="true" tabindex="-1"></a>aip <span class="sc">%&lt;&gt;%</span></span>
<span id="cb522-2"><a href="factors.html#cb522-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">species2=</span><span class="fu">fct_collapse</span>(species,</span>
<span id="cb522-3"><a href="factors.html#cb522-3" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;Acer sp.&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Acer rubrum&quot;</span>,<span class="st">&quot;Acer saccharum&quot;</span>,</span>
<span id="cb522-4"><a href="factors.html#cb522-4" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">&quot;Acer sp.&quot;</span>,<span class="st">&quot;Acer spicatum&quot;</span>),</span>
<span id="cb522-5"><a href="factors.html#cb522-5" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;Betula sp.&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Betula alleghaniensis&quot;</span>,</span>
<span id="cb522-6"><a href="factors.html#cb522-6" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;Betula papyrifera&quot;</span>,</span>
<span id="cb522-7"><a href="factors.html#cb522-7" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;Betula sp.&quot;</span>),</span>
<span id="cb522-8"><a href="factors.html#cb522-8" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;Unknown&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;unknown tree - hardwood&quot;</span>,</span>
<span id="cb522-9"><a href="factors.html#cb522-9" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;unknown tree - softwood&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb522-10"><a href="factors.html#cb522-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(species,<span class="at">.after=</span>species) <span class="sc">%&gt;%</span></span>
<span id="cb522-11"><a href="factors.html#cb522-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(species)</span>
<span id="cb522-12"><a href="factors.html#cb522-12" aria-hidden="true" tabindex="-1"></a>aip</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 26 x 5
#R&gt;      plot species        density basal_area species2      
#R&gt;     &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt; &lt;fct&gt;         
#R&gt;   1  1011 Abies balsamea   878.         2.5 Abies balsamea
#R&gt;   2  1031 Abies balsamea    33.3        0.1 Abies balsamea
#R&gt;   3  1034 Abies balsamea    66.7        0.1 Abies balsamea
#R&gt;   4  1035 Abies balsamea    22.2        0.1 Abies balsamea
#R&gt;   5  1011 Acer rubrum       11.1        0.4 Acer sp.      
#R&gt;   6  1031 Acer saccharum    55.6        0.1 Acer sp.      
#R&gt;   7  1034 Acer saccharum    11.1        0.1 Acer sp.      
#R&gt;   8  1035 Acer saccharum    11.1        0   Acer sp.      
#R&gt;   9  1031 Acer sp.          44.4        0.3 Acer sp.      
#R&gt;  10  1034 Acer spicatum     11.1        0   Acer sp.      
#R&gt;  # ... with 16 more rows</code></pre>
<p>To highlight the most abundance species in further analysis below, the levels of <code>species2</code> were ordered in descending values of the sum of <code>density</code> (using <code class="inline">fct_reorder()</code> and <code class="inline">fct_rev()</code>).</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r RCODE_ALONE"><code class="sourceCode r"><span id="cb524-1"><a href="factors.html#cb524-1" aria-hidden="true" tabindex="-1"></a>aip <span class="sc">%&lt;&gt;%</span></span>
<span id="cb524-2"><a href="factors.html#cb524-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">species2=</span><span class="fu">fct_rev</span>(<span class="fu">fct_reorder</span>(species2,density,<span class="at">.fun=</span>sum)))</span></code></pre></div>
<p>Total density and total basal area by level of <code>species2</code>, where the levels of <code>species2</code> are ordered in descending order of the total density is then shown below.</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb525-1"><a href="factors.html#cb525-1" aria-hidden="true" tabindex="-1"></a>aip_sum2 <span class="ot">&lt;-</span> aip <span class="sc">%&gt;%</span></span>
<span id="cb525-2"><a href="factors.html#cb525-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species2) <span class="sc">%&gt;%</span></span>
<span id="cb525-3"><a href="factors.html#cb525-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>(),</span>
<span id="cb525-4"><a href="factors.html#cb525-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">ttl_density=</span><span class="fu">sum</span>(density),</span>
<span id="cb525-5"><a href="factors.html#cb525-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">ttl_barea=</span><span class="fu">sum</span>(basal_area))</span>
<span id="cb525-6"><a href="factors.html#cb525-6" aria-hidden="true" tabindex="-1"></a>aip_sum2</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 8 x 4
#R&gt;    species2                n ttl_density ttl_barea
#R&gt;    &lt;fct&gt;               &lt;int&gt;       &lt;dbl&gt;     &lt;dbl&gt;
#R&gt;  1 Abies balsamea          4      1000         2.8
#R&gt;  2 Betula sp.              6       267.        4.8
#R&gt;  3 Unknown                 6       255.        5.5
#R&gt;  4 Acer sp.                6       144.        0.9
#R&gt;  5 Sorbus decora           1        22.2       0.2
#R&gt;  6 Populus tremuloides     1        22.2       1.5
#R&gt;  7 Thuja occidentalis      1        11.1       0.7
#R&gt;  8 Quercus rubra           1        11.1       0</code></pre>
<p>The result above indicate that four of the “species” dominated the results. It may be useful (especially if graphing these results) to “lump” the four least abundant “species” into an “Other” category. This type of “lumping” can be accomplished with <code class="inline">fct_lump_n()</code> which requires the factor variable as its first argument and<code class="inline">n=</code> to indicate the top <code>n</code> levels to <strong>not</strong> lump into an “Other” category. For example, the code below will lump all levels in <code>species2</code> after the top four into an “Other” category of the new <code>species3</code> variable. The summary results illustrate the lumping.</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb527-1"><a href="factors.html#cb527-1" aria-hidden="true" tabindex="-1"></a>aip <span class="ot">&lt;-</span> aip <span class="sc">%&gt;%</span></span>
<span id="cb527-2"><a href="factors.html#cb527-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">species3=</span><span class="fu">fct_lump_n</span>(species2,<span class="at">n=</span><span class="dv">4</span>))</span>
<span id="cb527-3"><a href="factors.html#cb527-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-4"><a href="factors.html#cb527-4" aria-hidden="true" tabindex="-1"></a>aip_sum3 <span class="ot">&lt;-</span> aip <span class="sc">%&gt;%</span></span>
<span id="cb527-5"><a href="factors.html#cb527-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species3) <span class="sc">%&gt;%</span></span>
<span id="cb527-6"><a href="factors.html#cb527-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>(),</span>
<span id="cb527-7"><a href="factors.html#cb527-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">ttl_density=</span><span class="fu">sum</span>(density),</span>
<span id="cb527-8"><a href="factors.html#cb527-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">ttl_barea=</span><span class="fu">sum</span>(basal_area))</span>
<span id="cb527-9"><a href="factors.html#cb527-9" aria-hidden="true" tabindex="-1"></a>aip_sum3</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 5 x 4
#R&gt;    species3           n ttl_density ttl_barea
#R&gt;    &lt;fct&gt;          &lt;int&gt;       &lt;dbl&gt;     &lt;dbl&gt;
#R&gt;  1 Abies balsamea     4      1000         2.8
#R&gt;  2 Betula sp.         6       267.        4.8
#R&gt;  3 Unknown            6       255.        5.5
#R&gt;  4 Acer sp.           6       144.        0.9
#R&gt;  5 Other              4        66.6       2.4</code></pre>
<p>Other versions of <code class="inline">fct_lump_XXX()</code>, such as <code class="inline">fct_lump_prop()</code> and <code class="inline">fct_lump_min()</code>, can be used when ordering by frequency rather than be another variable as shown here.</p>
<p> </p>
<p>Finally, the names of specific levels can be changed with <code class="inline">fct_recode()</code>. The first argument to this function is the original factor variable. Subsequent arguments are of the form new level name equal to old level name. Any levels not listed in <code class="inline">fct_recode()</code> will be retained with their original names. For example, the code below creates a new <code>species4</code> variable with new common names for the three “species” levels remaining in <code>species3</code>. The results are seen in the summary below.</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb529-1"><a href="factors.html#cb529-1" aria-hidden="true" tabindex="-1"></a>aip <span class="sc">%&lt;&gt;%</span></span>
<span id="cb529-2"><a href="factors.html#cb529-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">species4=</span><span class="fu">fct_recode</span>(species3,</span>
<span id="cb529-3"><a href="factors.html#cb529-3" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Maple&quot;</span> <span class="ot">=</span> <span class="st">&quot;Acer sp.&quot;</span>,</span>
<span id="cb529-4"><a href="factors.html#cb529-4" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Birch&quot;</span> <span class="ot">=</span> <span class="st">&quot;Betula sp.&quot;</span>,</span>
<span id="cb529-5"><a href="factors.html#cb529-5" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Balsam Fir&quot;</span> <span class="ot">=</span> <span class="st">&quot;Abies balsamea&quot;</span>))</span>
<span id="cb529-6"><a href="factors.html#cb529-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb529-7"><a href="factors.html#cb529-7" aria-hidden="true" tabindex="-1"></a>aip_sum4 <span class="ot">&lt;-</span> aip <span class="sc">%&gt;%</span></span>
<span id="cb529-8"><a href="factors.html#cb529-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species4) <span class="sc">%&gt;%</span></span>
<span id="cb529-9"><a href="factors.html#cb529-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>(),</span>
<span id="cb529-10"><a href="factors.html#cb529-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">ttl_density=</span><span class="fu">sum</span>(density),</span>
<span id="cb529-11"><a href="factors.html#cb529-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">ttl_barea=</span><span class="fu">sum</span>(basal_area))</span>
<span id="cb529-12"><a href="factors.html#cb529-12" aria-hidden="true" tabindex="-1"></a>aip_sum4</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 5 x 4
#R&gt;    species4       n ttl_density ttl_barea
#R&gt;    &lt;fct&gt;      &lt;int&gt;       &lt;dbl&gt;     &lt;dbl&gt;
#R&gt;  1 Balsam Fir     4      1000         2.8
#R&gt;  2 Birch          6       267.        4.8
#R&gt;  3 Unknown        6       255.        5.5
#R&gt;  4 Maple          6       144.        0.9
#R&gt;  5 Other          4        66.6       2.4</code></pre>
<p> </p>
</div>
<div id="examples-in-context-3" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Examples in Context</h2>
<div id="pulse-of-the-nation-survey" class="section level3" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> Pulse of the Nation Survey</h3>
<p><a href="https://www.cardsagainsthumanitysavesamerica.com/">Cards Against Humanity Saves America</a> created monthly polls to assess what they called the “Pulse of the Nation.” “Cards” partnered with Survey Sampling International to contact a nationally representative sample of the American public. For the first three polls, they contacted potential respondents on their cell phones and landlines, and a total of about 3000 adults ultimately participated i the poll. Results from the first poll are in <a href="https://raw.githubusercontent.com/droglenc/BookWrangling/main/data/201709-CAH_PulseOfTheNation.csv">201709-CAH_PulseOfTheNation.csv</a><a href="#fn51" class="footnote-ref" id="fnref51"><sup>51</sup></a>, which are read in below.</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb531-1"><a href="factors.html#cb531-1" aria-hidden="true" tabindex="-1"></a>PON <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;201709-CAH_PulseOfTheNation.csv&quot;</span>))</span>
<span id="cb531-2"><a href="factors.html#cb531-2" aria-hidden="true" tabindex="-1"></a>PON</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 1,000 x 28
#R&gt;     Income Gender   Age `Age Range` `Political Affiliation` `Do you approve or d~
#R&gt;      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;                   &lt;chr&gt;                
#R&gt;   1   8000 Female    64 55-64       Democrat                Strongly disapprove  
#R&gt;   2  68000 Female    56 55-64       Democrat                Strongly disapprove  
#R&gt;   3  46000 Male      63 55-64       Independent             Somewhat Approve     
#R&gt;   4  51000 Male      48 45-54       Republican              Strongly Approve     
#R&gt;   5 100000 Female    32 25-34       Democrat                Somewhat Approve     
#R&gt;   6  54000 Female    64 55-64       Democrat                Strongly disapprove  
#R&gt;   7  83000 Male      61 55-64       Independent             Somewhat Approve     
#R&gt;   8 114000 Female    64 55-64       Republican              Somewhat disapprove  
#R&gt;   9  90000 Female    64 55-64       Republican              Somewhat Approve     
#R&gt;  10   5000 Female    68 65+         Democrat                Somewhat disapprove  
#R&gt;  # ... with 990 more rows, and 22 more variables:
#R&gt;  #   What is your highest level of education? &lt;chr&gt;, Q5OTH1 &lt;chr&gt;,
#R&gt;  #   What is your race? &lt;chr&gt;, Q6OTH1 &lt;chr&gt;, What is your marital status? &lt;chr&gt;,
#R&gt;  #   Q7OTH1 &lt;chr&gt;, q8x &lt;chr&gt;,
#R&gt;  #   What would you say is the likelihood that your current job will be entirely performed by robots or computers within the next decade? &lt;chr&gt;,
#R&gt;  #   Do you believe that climate change is real and caused by people, real but not caused by people, or not real at all? &lt;chr&gt;,
#R&gt;  #   How many Transformers movies have you seen? &lt;dbl&gt;, q11x &lt;chr&gt;, ...</code></pre>
<p>The variables in the data frame are generally the actual questions asked in the poll. These are both difficult to read and to work with. To get a better look at these variables I used <code class="inline">names()</code>, which when given a data frame returns all the variable names of that data frame.</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb533-1"><a href="factors.html#cb533-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(PON)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;   [1] &quot;Income&quot;                                                                                                                              
#R&gt;   [2] &quot;Gender&quot;                                                                                                                              
#R&gt;   [3] &quot;Age&quot;                                                                                                                                 
#R&gt;   [4] &quot;Age Range&quot;                                                                                                                           
#R&gt;   [5] &quot;Political Affiliation&quot;                                                                                                               
#R&gt;   [6] &quot;Do you approve or disapprove of how Donald Trump is handling his job as president?&quot;                                                  
#R&gt;   [7] &quot;What is your highest level of education?&quot;                                                                                            
#R&gt;   [8] &quot;Q5OTH1&quot;                                                                                                                              
#R&gt;   [9] &quot;What is your race?&quot;                                                                                                                  
#R&gt;  [10] &quot;Q6OTH1&quot;                                                                                                                              
#R&gt;  [11] &quot;What is your marital status?&quot;                                                                                                        
#R&gt;  [12] &quot;Q7OTH1&quot;                                                                                                                              
#R&gt;  [13] &quot;q8x&quot;                                                                                                                                 
#R&gt;  [14] &quot;What would you say is the likelihood that your current job will be entirely performed by robots or computers within the next decade?&quot;
#R&gt;  [15] &quot;Do you believe that climate change is real and caused by people, real but not caused by people, or not real at all?&quot;                 
#R&gt;  [16] &quot;How many Transformers movies have you seen?&quot;                                                                                         
#R&gt;  [17] &quot;q11x&quot;                                                                                                                                
#R&gt;  [18] &quot;Do you agree or disagree with the following statement: scientists are generally honest and are serving the public good.&quot;             
#R&gt;  [19] &quot;Do you agree or disagree with the following statement: vaccines are safe and protect children from disease.&quot;                         
#R&gt;  [20] &quot;How many books, if any, have you read in the past year?&quot;                                                                             
#R&gt;  [21] &quot;q14x&quot;                                                                                                                                
#R&gt;  [22] &quot;Do you believe in ghosts?&quot;                                                                                                           
#R&gt;  [23] &quot;What percentage of the federal budget would you estimate is spent on scientific research?&quot;                                           
#R&gt;  [24] &quot;q16x&quot;                                                                                                                                
#R&gt;  [25] &quot;Is federal funding of scientific research too high, too low, or about right?&quot;                                                        
#R&gt;  [26] &quot;True or false: the earth is always farther away from the sun in the winter than in the summer.&quot;                                      
#R&gt;  [27] &quot;If you had to choose: would you rather be smart and sad, or dumb and happy?&quot;                                                         
#R&gt;  [28] &quot;Do you think it is acceptable or unacceptable to urinate in the shower?&quot;</code></pre>
<p>For this analysis I want to focus on the <code>Political Affiliation</code>, <code>Age Range</code>, and the three variables related to education, opinion about climate change, and opinion about the honesty of scientists. These last three variables have very long names so it will be easier to refer to them by their column <strong>number</strong>. From above, it is noted that the “education” variable is column 7, the climate change variable is in column 15, and the “scientists honesty” question is in column 18. In the code below, I rename each of the columns (and <code>Age Range</code>) and then reduce the data frame to just those variables.</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb535-1"><a href="factors.html#cb535-1" aria-hidden="true" tabindex="-1"></a>PON <span class="sc">%&lt;&gt;%</span></span>
<span id="cb535-2"><a href="factors.html#cb535-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">polit_aff=</span><span class="st">`</span><span class="at">Political Affiliation</span><span class="st">`</span>,<span class="at">age_range=</span><span class="st">`</span><span class="at">Age Range</span><span class="st">`</span>,</span>
<span id="cb535-3"><a href="factors.html#cb535-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">education=</span><span class="dv">7</span>,<span class="at">climate=</span><span class="dv">15</span>,<span class="at">scihon=</span><span class="dv">18</span>) <span class="sc">%&gt;%</span></span>
<span id="cb535-4"><a href="factors.html#cb535-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(polit_aff,age_range,education,climate,scihon)</span>
<span id="cb535-5"><a href="factors.html#cb535-5" aria-hidden="true" tabindex="-1"></a>PON</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 1,000 x 5
#R&gt;     polit_aff   age_range education      climate                       scihon    
#R&gt;     &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;                         &lt;chr&gt;     
#R&gt;   1 Democrat    55-64     College degree Real and Caused by People     Strongly ~
#R&gt;   2 Democrat    55-64     High school    DK/REF                        Somewhat ~
#R&gt;   3 Independent 55-64     Some college   Real but not Caused by People Somewhat ~
#R&gt;   4 Republican  45-54     High school    Not Real At All               Somewhat ~
#R&gt;   5 Democrat    25-34     Some college   Real and Caused by People     Strongly ~
#R&gt;   6 Democrat    55-64     Some college   Real and Caused by People     Strongly ~
#R&gt;   7 Independent 55-64     College degree Real but not Caused by People Strongly ~
#R&gt;   8 Republican  55-64     College degree Real and Caused by People     Somewhat ~
#R&gt;   9 Republican  55-64     High school    Real and Caused by People     Somewhat ~
#R&gt;  10 Democrat    65+       Some college   Real and Caused by People     Somewhat ~
#R&gt;  # ... with 990 more rows</code></pre>
<p>All remaining variables are categorical and for my analysis purposes I want each to be a factor. Before converting these variables to factors I examine the levels that appear in each.</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb537-1"><a href="factors.html#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(PON<span class="sc">$</span>polit_aff)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;Democrat&quot;    &quot;Independent&quot; &quot;Republican&quot;  &quot;DK/REF&quot;</code></pre>
<div class="sourceCode" id="cb539"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb539-1"><a href="factors.html#cb539-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(PON<span class="sc">$</span>age_range)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;55-64&quot; &quot;45-54&quot; &quot;25-34&quot; &quot;65+&quot;   &quot;35-44&quot; &quot;18-24&quot;</code></pre>
<div class="sourceCode" id="cb541"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb541-1"><a href="factors.html#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(PON<span class="sc">$</span>education)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;College degree&quot;  &quot;High school&quot;     &quot;Some college&quot;    &quot;Graduate degree&quot;
#R&gt;  [5] &quot;DK/REF&quot;          &quot;Other&quot;</code></pre>
<div class="sourceCode" id="cb543"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb543-1"><a href="factors.html#cb543-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(PON<span class="sc">$</span>climate)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;Real and Caused by People&quot;     &quot;DK/REF&quot;                       
#R&gt;  [3] &quot;Real but not Caused by People&quot; &quot;Not Real At All&quot;</code></pre>
<div class="sourceCode" id="cb545"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb545-1"><a href="factors.html#cb545-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(PON<span class="sc">$</span>scihon)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;Strongly Agree&quot;             &quot;Somewhat Agree&quot;            
#R&gt;  [3] &quot;Somewhat Disagree&quot;          &quot;Strongly Disagree&quot;         
#R&gt;  [5] &quot;DK/REF&quot;                     &quot;Neither Agree nor Disagree&quot;</code></pre>
<p>From this examination of levels, I made the following notes:</p>
<ul>
<li>Respondents were allowed to answer “Don’t Know” or refuse to answer which were coded as “DK/REF.” My general preference is to have “DK/REF” answers be the last level.</li>
<li>The levels for <code>age_range</code> will <strong>not</strong> need to be controlled because the numbers will naturally alphabetically order (as the numbers are all two digits; the order might not be natural if there were some one digit (say “1-17”) or three digit (say “100+”) numbers).</li>
<li>Levels in <code>education</code> and <code>scihon</code> need to be ordered according to their natural order (i.e., increasing education and increasing level of agreement).</li>
<li>I will order the levels for <code>climate</code> based on my understanding of what the correct answer is (i.e., I will order the answers from correct to less correct).</li>
<li>I will order the levels of <code>polit_aff</code> so that “Independent” is in the middle (which will happen alphabetically) and “DK/REF” is last.</li>
</ul>
<p>Creation of these factors is below. Note that to move “DK/REF” to the end of <code>polit_aff</code> I used <code class="inline">fct_relevel()</code> with <code class="inline">after=Inf</code> to move the level to the last position.</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r RCODE_ALONE"><code class="sourceCode r"><span id="cb547-1"><a href="factors.html#cb547-1" aria-hidden="true" tabindex="-1"></a>PON <span class="sc">%&lt;&gt;%</span></span>
<span id="cb547-2"><a href="factors.html#cb547-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">polit_aff=</span><span class="fu">factor</span>(polit_aff),</span>
<span id="cb547-3"><a href="factors.html#cb547-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">polit_aff=</span><span class="fu">fct_relevel</span>(polit_aff,<span class="st">&quot;DK/REF&quot;</span>,<span class="at">after=</span><span class="cn">Inf</span>),</span>
<span id="cb547-4"><a href="factors.html#cb547-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">age_range=</span><span class="fu">factor</span>(age_range),</span>
<span id="cb547-5"><a href="factors.html#cb547-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">education=</span><span class="fu">factor</span>(education,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;High school&quot;</span>,<span class="st">&quot;Some college&quot;</span>,</span>
<span id="cb547-6"><a href="factors.html#cb547-6" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">&quot;College degree&quot;</span>,<span class="st">&quot;Graduate degree&quot;</span>,</span>
<span id="cb547-7"><a href="factors.html#cb547-7" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">&quot;Other&quot;</span>,<span class="st">&quot;DK/REF&quot;</span>)),</span>
<span id="cb547-8"><a href="factors.html#cb547-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">climate=</span><span class="fu">factor</span>(climate,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Real and Caused by People&quot;</span>,</span>
<span id="cb547-9"><a href="factors.html#cb547-9" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">&quot;Real but not Caused by People&quot;</span>,</span>
<span id="cb547-10"><a href="factors.html#cb547-10" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">&quot;Not Real At All&quot;</span>,</span>
<span id="cb547-11"><a href="factors.html#cb547-11" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">&quot;DK/REF&quot;</span>)),</span>
<span id="cb547-12"><a href="factors.html#cb547-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">scihon=</span><span class="fu">factor</span>(scihon,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Strongly Disagree&quot;</span>,<span class="st">&quot;Somewhat Disagree&quot;</span>,</span>
<span id="cb547-13"><a href="factors.html#cb547-13" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">&quot;Neither Agree nor Disagree&quot;</span>,</span>
<span id="cb547-14"><a href="factors.html#cb547-14" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">&quot;Somewhat Agree&quot;</span>,<span class="st">&quot;Strongly Agree&quot;</span>,</span>
<span id="cb547-15"><a href="factors.html#cb547-15" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">&quot;DK/REF&quot;</span>)))</span></code></pre></div>
<p>I then used <code class="inline">levels()</code> to double-check that each factor has the levels and the order of levels that I expected.</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb548-1"><a href="factors.html#cb548-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(PON<span class="sc">$</span>polit_aff)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;Democrat&quot;    &quot;Independent&quot; &quot;Republican&quot;  &quot;DK/REF&quot;</code></pre>
<div class="sourceCode" id="cb550"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb550-1"><a href="factors.html#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(PON<span class="sc">$</span>age_range)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;18-24&quot; &quot;25-34&quot; &quot;35-44&quot; &quot;45-54&quot; &quot;55-64&quot; &quot;65+&quot;</code></pre>
<div class="sourceCode" id="cb552"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb552-1"><a href="factors.html#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(PON<span class="sc">$</span>education)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;High school&quot;     &quot;Some college&quot;    &quot;College degree&quot;  &quot;Graduate degree&quot;
#R&gt;  [5] &quot;Other&quot;           &quot;DK/REF&quot;</code></pre>
<div class="sourceCode" id="cb554"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb554-1"><a href="factors.html#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(PON<span class="sc">$</span>climate)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;Real and Caused by People&quot;     &quot;Real but not Caused by People&quot;
#R&gt;  [3] &quot;Not Real At All&quot;               &quot;DK/REF&quot;</code></pre>
<div class="sourceCode" id="cb556"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb556-1"><a href="factors.html#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(PON<span class="sc">$</span>scihon)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  [1] &quot;Strongly Disagree&quot;          &quot;Somewhat Disagree&quot;         
#R&gt;  [3] &quot;Neither Agree nor Disagree&quot; &quot;Somewhat Agree&quot;            
#R&gt;  [5] &quot;Strongly Agree&quot;             &quot;DK/REF&quot;</code></pre>
<p>Suppose the first analysis of interest is examining responses to the “scientists are generally honest and are serving the public good” question.</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb558-1"><a href="factors.html#cb558-1" aria-hidden="true" tabindex="-1"></a>sci_sum1 <span class="ot">&lt;-</span> PON <span class="sc">%&gt;%</span></span>
<span id="cb558-2"><a href="factors.html#cb558-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(scihon) <span class="sc">%&gt;%</span></span>
<span id="cb558-3"><a href="factors.html#cb558-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">freq=</span><span class="fu">n</span>())</span>
<span id="cb558-4"><a href="factors.html#cb558-4" aria-hidden="true" tabindex="-1"></a>sci_sum1</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 6 x 2
#R&gt;    scihon                      freq
#R&gt;    &lt;fct&gt;                      &lt;int&gt;
#R&gt;  1 Strongly Disagree            104
#R&gt;  2 Somewhat Disagree            133
#R&gt;  3 Neither Agree nor Disagree    19
#R&gt;  4 Somewhat Agree               335
#R&gt;  5 Strongly Agree               349
#R&gt;  6 DK/REF                        60</code></pre>
<p>Suppose that the analysts want to simplify this result for their audience by ignoring the “Don’t know or refused to answer” responses and collapsing all disagree answers to one level and all agree answers to one level.</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb560-1"><a href="factors.html#cb560-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> PON <span class="sc">%&gt;%</span></span>
<span id="cb560-2"><a href="factors.html#cb560-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(scihon<span class="sc">!=</span><span class="st">&quot;DK/REF&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb560-3"><a href="factors.html#cb560-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scihon=</span><span class="fu">fct_collapse</span>(scihon,</span>
<span id="cb560-4"><a href="factors.html#cb560-4" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Disagree&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Strongly Disagree&quot;</span>,<span class="st">&quot;Somewhat Disagree&quot;</span>),</span>
<span id="cb560-5"><a href="factors.html#cb560-5" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Agree&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Strongly Agree&quot;</span>,<span class="st">&quot;Somewhat Agree&quot;</span>)))</span>
<span id="cb560-6"><a href="factors.html#cb560-6" aria-hidden="true" tabindex="-1"></a>sci_sum2 <span class="ot">&lt;-</span> tmp <span class="sc">%&gt;%</span></span>
<span id="cb560-7"><a href="factors.html#cb560-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(scihon) <span class="sc">%&gt;%</span></span>
<span id="cb560-8"><a href="factors.html#cb560-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">freq=</span><span class="fu">n</span>())</span>
<span id="cb560-9"><a href="factors.html#cb560-9" aria-hidden="true" tabindex="-1"></a>sci_sum2</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 3 x 2
#R&gt;    scihon                      freq
#R&gt;    &lt;fct&gt;                      &lt;int&gt;
#R&gt;  1 Disagree                     237
#R&gt;  2 Neither Agree nor Disagree    19
#R&gt;  3 Agree                        684</code></pre>
<p>For fun, a graph of this summary is below.</p>
<p><img src="BookWrangling_files/figure-html/unnamed-chunk-282-1.png" width="432" style="display: block; margin: auto;" /></p>
<p> </p>
<p>Further suppose that the analysts want to summarize the question about climate change separately by political affiliation (for which an answer was provided).</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb562-1"><a href="factors.html#cb562-1" aria-hidden="true" tabindex="-1"></a>polclim_sum1 <span class="ot">&lt;-</span> PON <span class="sc">%&gt;%</span></span>
<span id="cb562-2"><a href="factors.html#cb562-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(polit_aff <span class="sc">!=</span> <span class="st">&quot;DK/REF&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb562-3"><a href="factors.html#cb562-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(polit_aff,climate) <span class="sc">%&gt;%</span></span>
<span id="cb562-4"><a href="factors.html#cb562-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">freq=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb562-5"><a href="factors.html#cb562-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc=</span>freq<span class="sc">/</span><span class="fu">sum</span>(freq)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb562-6"><a href="factors.html#cb562-6" aria-hidden="true" tabindex="-1"></a>polclim_sum1</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 12 x 4
#R&gt;  # Groups:   polit_aff [3]
#R&gt;     polit_aff   climate                        freq  perc
#R&gt;     &lt;fct&gt;       &lt;fct&gt;                         &lt;int&gt; &lt;dbl&gt;
#R&gt;   1 Democrat    Real and Caused by People       221 80.7 
#R&gt;   2 Democrat    Real but not Caused by People    28 10.2 
#R&gt;   3 Democrat    Not Real At All                  15  5.47
#R&gt;   4 Democrat    DK/REF                           10  3.65
#R&gt;   5 Independent Real and Caused by People       234 63.6 
#R&gt;   6 Independent Real but not Caused by People    69 18.8 
#R&gt;   7 Independent Not Real At All                  49 13.3 
#R&gt;   8 Independent DK/REF                           16  4.35
#R&gt;   9 Republican  Real and Caused by People        71 34.1 
#R&gt;  10 Republican  Real but not Caused by People    61 29.3 
#R&gt;  11 Republican  Not Real At All                  61 29.3 
#R&gt;  12 Republican  DK/REF                           15  7.21</code></pre>
<p>Suppose that the researchers want to compute a percentage of respondents that thought climate change was real, whether they had the cause correct or not. Further suppose that they wish to include the “DK/REF” answers with the “Not Real At All” answers under the assumption that if they thought climate change was real they would have responded as such.</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb564-1"><a href="factors.html#cb564-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> PON <span class="sc">%&gt;%</span></span>
<span id="cb564-2"><a href="factors.html#cb564-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(polit_aff <span class="sc">!=</span> <span class="st">&quot;DK/REF&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb564-3"><a href="factors.html#cb564-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climate=</span><span class="fu">fct_collapse</span>(climate,</span>
<span id="cb564-4"><a href="factors.html#cb564-4" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Real&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Real and Caused by People&quot;</span>,</span>
<span id="cb564-5"><a href="factors.html#cb564-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">&quot;Real but not Caused by People&quot;</span>),</span>
<span id="cb564-6"><a href="factors.html#cb564-6" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Not Real&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Not Real At All&quot;</span>,</span>
<span id="cb564-7"><a href="factors.html#cb564-7" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;DK/REF&quot;</span>)))</span>
<span id="cb564-8"><a href="factors.html#cb564-8" aria-hidden="true" tabindex="-1"></a>polclim_sum2 <span class="ot">&lt;-</span> tmp <span class="sc">%&gt;%</span></span>
<span id="cb564-9"><a href="factors.html#cb564-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(polit_aff,climate) <span class="sc">%&gt;%</span></span>
<span id="cb564-10"><a href="factors.html#cb564-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">freq=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb564-11"><a href="factors.html#cb564-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc=</span>freq<span class="sc">/</span><span class="fu">sum</span>(freq)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb564-12"><a href="factors.html#cb564-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb564-13"><a href="factors.html#cb564-13" aria-hidden="true" tabindex="-1"></a>polclim_sum2</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 6 x 4
#R&gt;    polit_aff   climate   freq  perc
#R&gt;    &lt;fct&gt;       &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt;
#R&gt;  1 Democrat    Real       249 90.9 
#R&gt;  2 Democrat    Not Real    25  9.12
#R&gt;  3 Independent Real       303 82.3 
#R&gt;  4 Independent Not Real    65 17.7 
#R&gt;  5 Republican  Real       132 63.5 
#R&gt;  6 Republican  Not Real    76 36.5</code></pre>
<p>And a graphic of the results for fun.</p>
<p><img src="BookWrangling_files/figure-html/unnamed-chunk-285-1.png" width="432" style="display: block; margin: auto;" /></p>
<p> </p>
</div>
<div id="enterococci-on-sydney-beaches" class="section level3" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> Enterococci on Sydney Beaches</h3>
<p>The Beachwatch Water Quality Program of Sydney, Australia measured the density (in colony forming units per 100 ml of water) of <a href="https://en.wikipedia.org/wiki/Enterococcus"><em>Enterococci</em></a> on Sydney beaches. The data from 2013 to 2018 was made available by the R-Ladies Sydney group and is in <a href="https://raw.githubusercontent.com/rladiessydney/RYouWithMe/master/sydneybeaches.csv">sydneybeaches.csv</a>.<a href="#fn52" class="footnote-ref" id="fnref52"><sup>52</sup></a> The data are loaded below.</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb566-1"><a href="factors.html#cb566-1" aria-hidden="true" tabindex="-1"></a>sb <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/rladiessydney/RYouWithMe/master/sydneybeaches.csv&quot;</span>)</span>
<span id="cb566-2"><a href="factors.html#cb566-2" aria-hidden="true" tabindex="-1"></a>sb</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 3,690 x 8
#R&gt;     BeachId Region    Council   Site   Longitude Latitude Date  `Enterococci (cf~
#R&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;
#R&gt;   1      25 Sydney C~ Randwick~ Clove~      151.    -33.9 02/0~                19
#R&gt;   2      25 Sydney C~ Randwick~ Clove~      151.    -33.9 06/0~                 3
#R&gt;   3      25 Sydney C~ Randwick~ Clove~      151.    -33.9 12/0~                 2
#R&gt;   4      25 Sydney C~ Randwick~ Clove~      151.    -33.9 18/0~                13
#R&gt;   5      25 Sydney C~ Randwick~ Clove~      151.    -33.9 30/0~                 8
#R&gt;   6      25 Sydney C~ Randwick~ Clove~      151.    -33.9 05/0~                 7
#R&gt;   7      25 Sydney C~ Randwick~ Clove~      151.    -33.9 11/0~                11
#R&gt;   8      25 Sydney C~ Randwick~ Clove~      151.    -33.9 23/0~                97
#R&gt;   9      25 Sydney C~ Randwick~ Clove~      151.    -33.9 07/0~                 3
#R&gt;  10      25 Sydney C~ Randwick~ Clove~      151.    -33.9 25/0~                 0
#R&gt;  # ... with 3,680 more rows</code></pre>
<p>For the demonstration here the <code>BeachId</code>, <code>Council</code>, and <code>Region</code> variables are not needed. The density of Enterococci is the last variable but its name is difficult to work with and will be renamed.</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb568-1"><a href="factors.html#cb568-1" aria-hidden="true" tabindex="-1"></a>sb <span class="sc">%&lt;&gt;%</span></span>
<span id="cb568-2"><a href="factors.html#cb568-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>BeachId,<span class="sc">-</span>Council,<span class="sc">-</span>Region) <span class="sc">%&gt;%</span></span>
<span id="cb568-3"><a href="factors.html#cb568-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">density=</span><span class="fu">last_col</span>())</span>
<span id="cb568-4"><a href="factors.html#cb568-4" aria-hidden="true" tabindex="-1"></a>sb</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 3,690 x 5
#R&gt;     Site           Longitude Latitude Date       density
#R&gt;     &lt;chr&gt;              &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;
#R&gt;   1 Clovelly Beach      151.    -33.9 02/01/2013      19
#R&gt;   2 Clovelly Beach      151.    -33.9 06/01/2013       3
#R&gt;   3 Clovelly Beach      151.    -33.9 12/01/2013       2
#R&gt;   4 Clovelly Beach      151.    -33.9 18/01/2013      13
#R&gt;   5 Clovelly Beach      151.    -33.9 30/01/2013       8
#R&gt;   6 Clovelly Beach      151.    -33.9 05/02/2013       7
#R&gt;   7 Clovelly Beach      151.    -33.9 11/02/2013      11
#R&gt;   8 Clovelly Beach      151.    -33.9 23/02/2013      97
#R&gt;   9 Clovelly Beach      151.    -33.9 07/03/2013       3
#R&gt;  10 Clovelly Beach      151.    -33.9 25/03/2013       0
#R&gt;  # ... with 3,680 more rows</code></pre>
<p>In one part of their analysis the researchers wanted to produce a plot of the mean and range of densities of <em>Enterococci</em> by beach. To aid understanding, however, they wanted the beaches ordered from south to north. The summary statistics below are calculated by <code>Site</code> converted to a factor class based on increasing <code>Latitude</code>. The latitudes are list with negative numbers (because Australia is in the southern hemisphere) so that more negative numbers are further south. Note the use of <code class="inline">na.rm=TRUE</code> in <code class="inline">fct_reorder()</code> because of the missing values at some sites.</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb570-1"><a href="factors.html#cb570-1" aria-hidden="true" tabindex="-1"></a>sb_sum1 <span class="ot">&lt;-</span> sb <span class="sc">%&gt;%</span></span>
<span id="cb570-2"><a href="factors.html#cb570-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Site=</span><span class="fu">fct_reorder</span>(Site,Latitude)) <span class="sc">%&gt;%</span></span>
<span id="cb570-3"><a href="factors.html#cb570-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Longitude,Latitude,Site) <span class="sc">%&gt;%</span></span>
<span id="cb570-4"><a href="factors.html#cb570-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>(),</span>
<span id="cb570-5"><a href="factors.html#cb570-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">valid_n=</span><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(density)),</span>
<span id="cb570-6"><a href="factors.html#cb570-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">mn_density=</span><span class="fu">mean</span>(density,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb570-7"><a href="factors.html#cb570-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_density=</span><span class="fu">sd</span>(density,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb570-8"><a href="factors.html#cb570-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_density=</span><span class="fu">min</span>(density,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb570-9"><a href="factors.html#cb570-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_density=</span><span class="fu">max</span>(density,<span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb570-10"><a href="factors.html#cb570-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb570-11"><a href="factors.html#cb570-11" aria-hidden="true" tabindex="-1"></a>sb_sum1</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 11 x 9
#R&gt;     Longitude Latitude Site           n valid_n mn_density sd_density min_density
#R&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;      &lt;int&gt;   &lt;int&gt;      &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
#R&gt;   1      151.    -34.0 Little Ba~   338     336       45.6      297.            0
#R&gt;   2      151.    -34.0 Malabar B~   343     341       68.1      214.            0
#R&gt;   3      151.    -34.0 South Mar~   338     336       15.7       77.0           0
#R&gt;   4      151.    -33.9 Maroubra ~   338     335       20.2      123.            0
#R&gt;   5      151.    -33.9 Coogee Be~   342     339       39.4      109.            0
#R&gt;   6      151.    -34.0 South Mar~   316     314       63.9      210.            0
#R&gt;   7      151.    -33.9 Gordons B~   324     322       24.9      120.            0
#R&gt;   8      151.    -33.9 Clovelly ~   338     334       10.2       26.4           0
#R&gt;   9      151.    -33.9 Bronte Be~   338     335       31.4      126.            0
#R&gt;  10      151.    -33.9 Tamarama ~   337     335       35.7      129.            0
#R&gt;  11      151.    -33.9 Bondi Bea~   338     334       18.8       51.9           0
#R&gt;  # ... with 1 more variable: max_density &lt;dbl&gt;</code></pre>
<p>The desired plot is shown below (with the southern-most beach at the bottom of the y-axis).</p>
<p><img src="BookWrangling_files/figure-html/unnamed-chunk-289-1.png" width="480" style="display: block; margin: auto;" /></p>
<p> </p>
<p>Other researchers would prefer that the beaches be ordered from lowest to highest density of <em>Enterococci</em>. The code below creates a summary by <code>Site</code>s ordered by the mean <code>density</code>.</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb572-1"><a href="factors.html#cb572-1" aria-hidden="true" tabindex="-1"></a>sb_sum2 <span class="ot">&lt;-</span> sb <span class="sc">%&gt;%</span></span>
<span id="cb572-2"><a href="factors.html#cb572-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Site=</span><span class="fu">fct_reorder</span>(Site,density,<span class="at">.fun=</span>mean,<span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb572-3"><a href="factors.html#cb572-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site,Longitude,Latitude) <span class="sc">%&gt;%</span></span>
<span id="cb572-4"><a href="factors.html#cb572-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>(),</span>
<span id="cb572-5"><a href="factors.html#cb572-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">valid_n=</span><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(density)),</span>
<span id="cb572-6"><a href="factors.html#cb572-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">mn_density=</span><span class="fu">mean</span>(density,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb572-7"><a href="factors.html#cb572-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_density=</span><span class="fu">sd</span>(density,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb572-8"><a href="factors.html#cb572-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_density=</span><span class="fu">min</span>(density,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb572-9"><a href="factors.html#cb572-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_density=</span><span class="fu">max</span>(density,<span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb572-10"><a href="factors.html#cb572-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb572-11"><a href="factors.html#cb572-11" aria-hidden="true" tabindex="-1"></a>sb_sum2</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;  # A tibble: 11 x 9
#R&gt;     Site       Longitude Latitude     n valid_n mn_density sd_density min_density
#R&gt;     &lt;fct&gt;          &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;   &lt;int&gt;      &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
#R&gt;   1 Clovelly ~      151.    -33.9   338     334       10.2       26.4           0
#R&gt;   2 South Mar~      151.    -34.0   338     336       15.7       77.0           0
#R&gt;   3 Bondi Bea~      151.    -33.9   338     334       18.8       51.9           0
#R&gt;   4 Maroubra ~      151.    -33.9   338     335       20.2      123.            0
#R&gt;   5 Gordons B~      151.    -33.9   324     322       24.9      120.            0
#R&gt;   6 Bronte Be~      151.    -33.9   338     335       31.4      126.            0
#R&gt;   7 Tamarama ~      151.    -33.9   337     335       35.7      129.            0
#R&gt;   8 Coogee Be~      151.    -33.9   342     339       39.4      109.            0
#R&gt;   9 Little Ba~      151.    -34.0   338     336       45.6      297.            0
#R&gt;  10 South Mar~      151.    -34.0   316     314       63.9      210.            0
#R&gt;  11 Malabar B~      151.    -34.0   343     341       68.1      214.            0
#R&gt;  # ... with 1 more variable: max_density &lt;dbl&gt;</code></pre>
<p><img src="BookWrangling_files/figure-html/unnamed-chunk-291-1.png" width="480" style="display: block; margin: auto;" /></p>
<p> </p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="47">
<li id="fn47"><p>See that “1” is now mapped to “Douglas,” “2” to “Bayfield,” and “3” to “Ashland.”<a href="factors.html#fnref47" class="footnote-back">↩︎</a></p></li>
<li id="fn48"><p>Note that <code>.fun</code> is only useful if multiple observations of the factor variable are present and it defaults to using the median.<a href="factors.html#fnref48" class="footnote-back">↩︎</a></p></li>
<li id="fn49"><p>Note that Jessica Grochowski, now Jessica Kirschbaum, is a Northland alum.<a href="factors.html#fnref49" class="footnote-back">↩︎</a></p></li>
<li id="fn50"><p>Compare the <code>species</code> to <code>species2</code> columns below to confirm how the “refactoring” worked.<a href="factors.html#fnref50" class="footnote-back">↩︎</a></p></li>
<li id="fn51"><p>These data are from <a href="https://www.kaggle.com/cardsagainsthumanity/pulse-of-the-nation">Kaggle</a><a href="factors.html#fnref51" class="footnote-back">↩︎</a></p></li>
<li id="fn52"><p>Data from <a href="https://rladiessydney.org/courses/ryouwithme/01-basicbasics-3/">this online book</a>.<a href="factors.html#fnref52" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dates-and-times.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="strings.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
