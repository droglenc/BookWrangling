<!DOCTYPE html>
<html lang="en" xml:lang="en">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 3 External Data Files | Readings for MTH250 - Data Wrangling</title>
  <meta name="description" content="This book contains the readings for MTH250W at Northland College." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 3 External Data Files | Readings for MTH250 - Data Wrangling" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://derekogle.com/BookWrangling/" />
  
  <meta property="og:description" content="This book contains the readings for MTH250W at Northland College." />
  <meta name="github-repo" content="droglenc/BookWrangling" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 3 External Data Files | Readings for MTH250 - Data Wrangling" />
  
  <meta name="twitter:description" content="This book contains the readings for MTH250W at Northland College." />
  

<meta name="author" content="Derek H. Ogle" />


<meta name="date" content="2021-07-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-structures.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Readings for Data Wrangling in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="preparation.html"><a href="preparation.html"><i class="fa fa-check"></i><b>1</b> Preparation</a></li>
<li class="chapter" data-level="2" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>2</b> Data Structures</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-structures.html"><a href="data-structures.html#vectors"><i class="fa fa-check"></i><b>2.1</b> Vectors</a></li>
<li class="chapter" data-level="2.2" data-path="data-structures.html"><a href="data-structures.html#data-classes"><i class="fa fa-check"></i><b>2.2</b> Data Classes</a></li>
<li class="chapter" data-level="2.3" data-path="data-structures.html"><a href="data-structures.html#data-frames"><i class="fa fa-check"></i><b>2.3</b> Data Frames</a></li>
<li class="chapter" data-level="2.4" data-path="data-structures.html"><a href="data-structures.html#tidy-data"><i class="fa fa-check"></i><b>2.4</b> Tidy Data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="external-data-files.html"><a href="external-data-files.html"><i class="fa fa-check"></i><b>3</b> External Data Files</a>
<ul>
<li class="chapter" data-level="3.1" data-path="external-data-files.html"><a href="external-data-files.html#entering-data"><i class="fa fa-check"></i><b>3.1</b> Entering Data</a></li>
<li class="chapter" data-level="3.2" data-path="external-data-files.html"><a href="external-data-files.html#saving-the-external-file"><i class="fa fa-check"></i><b>3.2</b> Saving the External File</a></li>
<li class="chapter" data-level="3.3" data-path="external-data-files.html"><a href="external-data-files.html#reading-the-external-file"><i class="fa fa-check"></i><b>3.3</b> Reading the External File</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Readings for MTH250 - Data Wrangling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="external-data-files" class="section level1" number="3">
<h1><span class="header-section-number">Module 3</span> External Data Files</h1>
<p>Most realistic data has more than a few individuals and is, thus, not easily entered using <code>data.frame()</code> or <code>tibble()</code> as shown in Section <a href="data-structures.html#data-frames">2.3</a>. Rather these data are often entered and stored in a spreadsheet or database that is external to R and, thus, needs to be read or loaded into R. This module describes how data should be entered into a spreadsheet and then how that data is read into R.</p>
<div id="entering-data" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Entering Data</h2>
<p>Tidy data (see Section <a href="data-structures.html#tidy-data">2.4</a>) is often read into a spreadsheet program such as Microsoft Excel or Google Sheets. The spreadsheet should be organized with variables in columns and individuals in rows, with the exception that <strong>the first row should contain variable names.</strong> The example spreadsheet below shows the length (cm), weight (kg), and capture location data for a small sample of Black Bears.</p>
<p><img src="zimgs/Data_File_1.jpg" width="30%" style="display: block; margin: auto;" /></p>
<p> </p>
<p><strong>Variable names should NOT contain spaces.</strong> For example, don’t use “total length” or “length (cm).” If you feel the need to have longer variable names, then separate the parts with a period (e.g., “length.cm”) or an underscore (e.g., “length_cm”). <strong>Variable names can NOT start with numbers or contain “special” characters</strong> such as “~,” “!” “&amp;,” “@,” etc. Furthermore, numerical measurements should NOT include units (e.g., don’t use “7 cm”). Finally, for categorical data, make sure that all categories are consistent (e.g., do not use both “bayfield” and “Bayfield”).</p>
<p>When entering data make sure to follow the three rules of tidy data (see Section <a href="data-structures.html#tidy-data">2.4</a>). For example, the following data are methyl mercury levels recorded in mussels captured from “impacted” and “reference” locations.</p>
<pre><code>  impacted   0.011  0.054  0.056  0.095  0.051  0.077
  reference  0.031  0.040  0.029  0.066  0.018  0.042  0.044</code></pre>
<p>As described in Section <a href="data-structures.html#tidy-data">2.4</a>, one “observation” (i.e., row) is a methyl mercury measurement on a mussel AND which group the mussel belongs. The rules for tidy data dictate two columns (one for each of the two variables recorded) and 13 rows (one for each obseration of a mussel). format as follows. Thus, these data would be entered into the spreadsheet as shown below.</p>
<p><img src="zimgs/StackedData.jpg" width="25%" style="display: block; margin: auto;" /></p>
<p> </p>
</div>
<div id="saving-the-external-file" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Saving the External File</h2>
<p>The spreadsheet may be saved in the format of the spreadsheet program (e.g., as an Excel file) to be read into R. However, it is also common to save the file as a <em>comma separated values</em> (CSV) file to be read into R. The advantage of a CSV file is that these files are small and, because they do not require any special software (e.g., Excel) to read, they are very likely to always be able to be read into R.</p>
<div id="excel" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Excel</h3>
<p>An Excel worksheet is saved as a CSV file by selecting the <strong>File..Save As</strong> menu item, which will produce the dialog box below. In this dialog box, change “Save as type” to “CSV (Comma delimited),”<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>, provide a file name (<strong>do not put any periods in the name</strong>), select a location to save the file (<strong>this should be the same location as your assignment template file</strong>), and press “Save.” Two “warning” dialog boxes may then appear – select “OK” for the first and “YES” for the second. You can now close the spreadsheet file.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<p><img src="zimgs/Data_File_2.jpg" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="google-sheets" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Google Sheets</h3>
<p>A Google Sheet can be made available as a CSV file with the following steps by selecting the “File” menu, “Share” submenu, and “Publish to web” submenu. In the ensuing dialog box, change “Entire Document” to name of the sheet you want to publish and “Web Page” to “Comma-separated values (.csv)” under the “Link” tab.</p>
<p><img src="zimgs/GoogleSheet_1.JPG" width="50%" style="display: block; margin: auto;" /></p>
<p>Then press the “Publish” button and press OK when asked to confirm publishing.</p>
<p><img src="zimgs/GoogleSheet_2.JPG" width="50%" style="display: block; margin: auto;" /></p>
<p>Finally, select and copy (CTRL-C or CMD-C) the entire link shown in the box above. This link will be used as described in the next section.</p>
</div>
</div>
<div id="reading-the-external-file" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Reading the External File</h2>
<div id="csv-files" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> CSV Files</h3>
<p>CSV files may be read with <code>read.csv()</code> from base R or <code>read_csv()</code> from <code>tidyverse</code>. For most of our applications there will be little functional difference between these two functions. However, <code>read_csv()</code> is faster than <code>read.csv()</code> and can be a little “smarter” about the way it imports certain columns.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> In addition, it is a bit more transparent about what it is doing. For those reasons, we will use <code>read_csv()</code> in this course.</p>
<div class="tip">
<p>An object saved from <code>read_csv()</code> will be a tibble.</p>
</div>
<p>The first argument to <code>read_csv()</code> is the filename. This file must exist in your working directory, include be a partial path relative to your working directory or a full path to the file, or be a valid URL. For example, the code below reads “Bears.csv” from the “data” folder in my working directory and stores the result in the <code>bears</code> object. Here, I used <code>file.path()</code> to combine the folder names in the partial path with the filename because <code>file.path()</code> creates at path that will be correct for your operating system.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb62-1"><a href="external-data-files.html#cb62-1" aria-hidden="true" tabindex="-1"></a>bears <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;Bears.csv&quot;</span>))</span>
<span id="cb62-2"><a href="external-data-files.html#cb62-2" aria-hidden="true" tabindex="-1"></a>bears</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;   # A tibble: 8 x 3
#R&gt;     length.cm weight.kg loc     
#R&gt;         &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   
#R&gt;   1      139        110 Bayfield
#R&gt;   2      120.        60 Bayfield
#R&gt;   3      149         85 Bayfield
#R&gt;   4      141        100 Ashland 
#R&gt;   5      141         95 Ashland 
#R&gt;   6      150         85 Douglas 
#R&gt;   7      130.       105 Douglas 
#R&gt;   8      150        110 Douglas</code></pre>
<p>The filename argument could also be the link to the published Google Sheet (from above).</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb64-1"><a href="external-data-files.html#cb64-1" aria-hidden="true" tabindex="-1"></a>bears <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://docs.google.com/spreadsheets/d/e/2PACX-1vQaxD9tvwL29MydISlYw4bVXrw6-rvkEbT_2qFGxw7HuYX6M3h83aIYT4eZ-mrrEfJf8y5Q8p1Rkn4Z/pub?gid=522647677&amp;single=true&amp;output=csv&quot;</span>)</span>
<span id="cb64-2"><a href="external-data-files.html#cb64-2" aria-hidden="true" tabindex="-1"></a>bears</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;   # A tibble: 8 x 3
#R&gt;     length.cm weight.kg loc     
#R&gt;         &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   
#R&gt;   1      139        110 Bayfield
#R&gt;   2      120.        60 Bayfield
#R&gt;   3      149         85 Bayfield
#R&gt;   4      141        100 Ashland 
#R&gt;   5      141         95 Ashland 
#R&gt;   6      150         85 Douglas 
#R&gt;   7      130.       105 Douglas 
#R&gt;   8      150        110 Douglas</code></pre>
<p>The URL does not have to be from the published Google Sheet. For example, the following reads a CSV from <a href="https://sports-statistics.com/sports-data/nba-basketball-datasets-csv-files/">this page</a> that lists information about every player who has played in the National Basketball Association (NBA).</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb66-1"><a href="external-data-files.html#cb66-1" aria-hidden="true" tabindex="-1"></a>players <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://sports-statistics.com/database/basketball-data/nba/NBA-playerlist.csv&quot;</span>)</span>
<span id="cb66-2"><a href="external-data-files.html#cb66-2" aria-hidden="true" tabindex="-1"></a>players</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;   # A tibble: 4,393 x 15
#R&gt;         X1 DISPLAY_FIRST_LAST  DISPLAY_LAST_COMMA_FIRST FROM_YEAR GAMES_PLAYED_FL~
#R&gt;      &lt;dbl&gt; &lt;chr&gt;               &lt;chr&gt;                        &lt;dbl&gt; &lt;chr&gt;           
#R&gt;    1     0 Alaa Abdelnaby      Abdelnaby, Alaa               1990 Y               
#R&gt;    2     1 Zaid Abdul-Aziz     Abdul-Aziz, Zaid              1968 Y               
#R&gt;    3     2 Kareem Abdul-Jabbar Abdul-Jabbar, Kareem          1969 Y               
#R&gt;    4     3 Mahmoud Abdul-Rauf  Abdul-Rauf, Mahmoud           1990 Y               
#R&gt;    5     4 Tariq Abdul-Wahad   Abdul-Wahad, Tariq            1997 Y               
#R&gt;    6     5 Shareef Abdur-Rahim Abdur-Rahim, Shareef          1996 Y               
#R&gt;    7     6 Tom Abernethy       Abernethy, Tom                1976 Y               
#R&gt;    8     7 Forest Able         Able, Forest                  1956 Y               
#R&gt;    9     8 John Abramovic      Abramovic, John               1946 Y               
#R&gt;   10     9 Alex Abrines        Abrines, Alex                 2016 Y               
#R&gt;   # ... with 4,383 more rows, and 10 more variables:
#R&gt;   #   OTHERLEAGUE_EXPERIENCE_CH &lt;chr&gt;, PERSON_ID &lt;dbl&gt;, PLAYERCODE &lt;chr&gt;,
#R&gt;   #   ROSTERSTATUS &lt;dbl&gt;, TEAM_ABBREVIATION &lt;chr&gt;, TEAM_CITY &lt;chr&gt;,
#R&gt;   #   TEAM_CODE &lt;chr&gt;, TEAM_ID &lt;dbl&gt;, TEAM_NAME &lt;chr&gt;, TO_YEAR &lt;dbl&gt;</code></pre>
<p> </p>
<p>The <code>read_csv()</code> function provides a variety of options that will help you correctly load CSV files that may be “quirky” in some respects. Use <code>skip.lines=</code> to skip, for example, the first two lines in a CSV file that do not contain data (perhaps they hold comments).</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb68-1"><a href="external-data-files.html#cb68-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;Bears_SkipLines.csv&quot;</span>),<span class="at">skip=</span><span class="dv">2</span>)</span>
<span id="cb68-2"><a href="external-data-files.html#cb68-2" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;   # A tibble: 8 x 3
#R&gt;     length.cm weight.kg loc     
#R&gt;         &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   
#R&gt;   1      139        110 Bayfield
#R&gt;   2      120.        60 Bayfield
#R&gt;   3      149         85 Bayfield
#R&gt;   4      141        100 Ashland 
#R&gt;   5      141         95 Ashland 
#R&gt;   6      150         85 Douglas 
#R&gt;   7      130.       105 Douglas 
#R&gt;   8      150        110 Douglas</code></pre>
<p>Alternatively, use <code>comment=</code> to identify leading characters that identify lines in the data file that are comments and should not be read as data.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb70-1"><a href="external-data-files.html#cb70-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;Bears_Comment.csv&quot;</span>),<span class="at">comment=</span><span class="st">&quot;#&quot;</span>)</span>
<span id="cb70-2"><a href="external-data-files.html#cb70-2" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;   # A tibble: 8 x 3
#R&gt;     length.cm weight.kg loc     
#R&gt;         &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   
#R&gt;   1      139        110 Bayfield
#R&gt;   2      120.        60 Bayfield
#R&gt;   3      149         85 Bayfield
#R&gt;   4      141        100 Ashland 
#R&gt;   5      141         95 Ashland 
#R&gt;   6      150         85 Douglas 
#R&gt;   7      130.       105 Douglas 
#R&gt;   8      150        110 Douglas</code></pre>
<p>Often data may be missing. By default, R treats <code>NA</code> in the data frame as missing data. If all missing data is coded with <code>NA</code> then <code>read_csv()</code> will handle this properly. For example, note the <code>NA</code>s in the second and eighth rows below.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb72-1"><a href="external-data-files.html#cb72-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;Bears_Missing1.csv&quot;</span>))</span>
<span id="cb72-2"><a href="external-data-files.html#cb72-2" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;   # A tibble: 8 x 3
#R&gt;     length.cm weight.kg loc     
#R&gt;         &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   
#R&gt;   1      139        110 Bayfield
#R&gt;   2       NA         60 Bayfield
#R&gt;   3      149         85 Bayfield
#R&gt;   4      141        100 Ashland 
#R&gt;   5      141         95 Ashland 
#R&gt;   6      150         85 Douglas 
#R&gt;   7      130.       105 Douglas 
#R&gt;   8      150        110 &lt;NA&gt;</code></pre>
<p>However, some researcher may denote missing data with other codes. For example, the data file read below used “-” denote missing data. In cases like this, use <code>na=</code> to dictate which codes should be “missing” and converted to <code>NA</code> in the data frame object.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb74-1"><a href="external-data-files.html#cb74-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;Bears_Missing2.csv&quot;</span>),<span class="at">na=</span><span class="st">&quot;-&quot;</span>)</span>
<span id="cb74-2"><a href="external-data-files.html#cb74-2" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;   # A tibble: 8 x 3
#R&gt;     length.cm weight.kg loc     
#R&gt;         &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   
#R&gt;   1      139        110 Bayfield
#R&gt;   2       NA         60 Bayfield
#R&gt;   3      149         85 Bayfield
#R&gt;   4      141        100 Ashland 
#R&gt;   5      141         95 Ashland 
#R&gt;   6      150         85 Douglas 
#R&gt;   7      130.       105 Douglas 
#R&gt;   8      150        110 &lt;NA&gt;</code></pre>
<p>In other instances, the research may have sloppily used multiple codes for missing data. In these instances, set <code>na=</code> to a vector of all codes to be converted to <code>NA</code> in the data frame object.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb76-1"><a href="external-data-files.html#cb76-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;Bears_Missing3.csv&quot;</span>),<span class="at">na=</span><span class="fu">c</span>(<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NAN&quot;</span>,<span class="st">&quot;-&quot;</span>))</span>
<span id="cb76-2"><a href="external-data-files.html#cb76-2" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;   # A tibble: 8 x 3
#R&gt;     length.cm weight.kg loc     
#R&gt;         &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   
#R&gt;   1      139        110 &lt;NA&gt;    
#R&gt;   2       NA         60 Bayfield
#R&gt;   3      149         85 Bayfield
#R&gt;   4      141        100 Ashland 
#R&gt;   5       NA         95 Ashland 
#R&gt;   6      150         85 Douglas 
#R&gt;   7      130.       105 Douglas 
#R&gt;   8      150        110 &lt;NA&gt;</code></pre>
<p> </p>
<p>The examples above will serve you well for most files read in this class, with the possible exception of files that contain variables with dates. Handling dates is discussed XXXXXX.</p>
</div>
<div id="excel-files" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Excel Files</h3>
<p>Some researchers prefer to save data entered in Excel as an Excel workbook rather than a CSV file. The main argument here is that saving to a CSV often results in two files – an Excel workbook file and a CSV file. It is generally bad practice to have your data in two files as you may update the Excel file and forget to save it to the CSV file or you may update the CSV file and forget to also update the Excel file. Regardless of the reason, data can generally be read from an Excel file into R.</p>
<p>The <code>read_excel()</code> function from the <code>readxl</code> package provides a coherent process for reading data from an Excel workbook. The first argument to <code>read_excel()</code> is the name of the Excel file, possibly with path information. By default <code>read_excel()</code> reads the first sheet in the Excel workbook. The example below reads the first sheet of the “DataExamples.xlsx” workbook in the “data” folder.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb78-1"><a href="external-data-files.html#cb78-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;DataExamples.xlsx&quot;</span>))</span>
<span id="cb78-2"><a href="external-data-files.html#cb78-2" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;   # A tibble: 8 x 3
#R&gt;     length.cm weight.kg loc     
#R&gt;         &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   
#R&gt;   1      139        110 Bayfield
#R&gt;   2      120.        60 Bayfield
#R&gt;   3      149         85 Bayfield
#R&gt;   4      141        100 Ashland 
#R&gt;   5      141         95 Ashland 
#R&gt;   6      150         85 Douglas 
#R&gt;   7      130.       105 Douglas 
#R&gt;   8      150        110 Douglas</code></pre>
<p>Data on specific sheets can be read by including the sheet name in <code>sheet=</code>. Additionally, lines at the top of the sheet can be skipped with <code>skip=</code> as described for <code>read_csv()</code>. For example, the code below reads the data after the first two lines in the “Bears_SkipLines” worksheet in the same Excel workbook.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb80-1"><a href="external-data-files.html#cb80-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;DataExamples.xlsx&quot;</span>),</span>
<span id="cb80-2"><a href="external-data-files.html#cb80-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sheet=</span><span class="st">&quot;Bears_SkipLines&quot;</span>,<span class="at">skip=</span><span class="dv">2</span>)</span>
<span id="cb80-3"><a href="external-data-files.html#cb80-3" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;   # A tibble: 8 x 3
#R&gt;     length.cm weight.kg loc     
#R&gt;         &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   
#R&gt;   1      139        110 Bayfield
#R&gt;   2      120.        60 Bayfield
#R&gt;   3      149         85 Bayfield
#R&gt;   4      141        100 Ashland 
#R&gt;   5      141         95 Ashland 
#R&gt;   6      150         85 Douglas 
#R&gt;   7      130.       105 Douglas 
#R&gt;   8      150        110 Douglas</code></pre>
<p>Missing data is handled exactly as described for <code>read_csv()</code>.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb82-1"><a href="external-data-files.html#cb82-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;DataExamples.xlsx&quot;</span>),</span>
<span id="cb82-2"><a href="external-data-files.html#cb82-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sheet=</span><span class="st">&quot;Bears_Missing3&quot;</span>,<span class="at">na=</span><span class="fu">c</span>(<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NAN&quot;</span>,<span class="st">&quot;-&quot;</span>))</span>
<span id="cb82-3"><a href="external-data-files.html#cb82-3" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;   # A tibble: 8 x 3
#R&gt;     length.cm weight.kg loc     
#R&gt;         &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   
#R&gt;   1      139        110 &lt;NA&gt;    
#R&gt;   2       NA         60 Bayfield
#R&gt;   3      149         85 Bayfield
#R&gt;   4      141        100 Ashland 
#R&gt;   5       NA         95 Ashland 
#R&gt;   6      150         85 Douglas 
#R&gt;   7      130.       105 Douglas 
#R&gt;   8      150        110 &lt;NA&gt;</code></pre>
<p> </p>
<p>In general, <code>read_excel()</code> works best if the data are arranged rectangularly starting in cell “A1.” However, <code>read_excel()</code> can handle different organizations of data in the worksheet as described <a href="https://readxl.tidyverse.org/articles/sheet-geometry.html">here</a>. Researchers may also use multiple header rows in their Excel worksheet; e.g., variables names in the first row, variable units in the second row. <a href="https://readxl.tidyverse.org/articles/articles/multiple-header-rows.html">This</a> provides a strategy for reading data arranged in such a way.</p>
<p>The examples above will serve you well for most files read in this class, with the possible exception of files that contain variables with dates. Handling dates is discussed XXXXXX.</p>
</div>
<div id="google-sheets-1" class="section level3" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Google Sheets</h3>
<p>It is also possible to read a file directly from Google Sheets using functions in the <code>googlesheets4</code> package as described <a href="https://googlesheets4.tidyverse.org/articles/articles/read-sheets.html">here</a>. Using this package to read directly from Google Sheets requires you to authorize R to access your Google Sheets.</p>
</div>
<div id="other-formats" class="section level3" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Other Formats</h3>
<p>Data may be stored in other, less common formats. A rew examples of functions to read these other formats are listed below.</p>
<ul>
<li><code>read_csv2()</code> (from <code>tidyverse</code>) for fields separated by semi-colons (rather than commas) as is common in Europe.</li>
<li><code>read_tsv()</code> (from <code>tidyverse</code>) for fields separated by tabs (rather than commas).</li>
<li><code>read_fwf()</code> (from <code>tidyverse</code>) for fields that are a fixed width.</li>
<li><code>read_sav()</code> (from <code>haven</code>) for “.sav” files from SPSS.</li>
<li><code>read_sas()</code> (from <code>haven</code>) for “.sas7bdat” and “.sas7bcat” files from SAS.</li>
<li><code>read_dta()</code> (from <code>haven</code>) for “.dta” files from Stata.</li>
</ul>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>There are several choices for CSV files here; do NOT choose the one with “UTF-8” in the name.<a href="external-data-files.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>You may be asked to save changes – you should say “No.”<a href="external-data-files.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>How <code>read_csv()</code> identifies the class of data in a column is described <a href="https://r4ds.had.co.nz/data-import.html#parsing-a-file">here</a><a href="external-data-files.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Windows and Mac OS handle paths differently; this function avoids that complication.<a href="external-data-files.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>I use the <code>readxl::read_excel()</code> construct here rather than loading the <code>readxl</code> package and then simply using <code>read_excel()</code> because this is the only function that I will use from <code>readxl</code>. Thus, I am not loading unneeded functions into my work environment.<a href="external-data-files.html#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-structures.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

</body>

</html>
